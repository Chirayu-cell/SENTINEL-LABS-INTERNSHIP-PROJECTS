# REGWATCH SENTINEL üõ°Ô∏è  
### Host-Based Windows Registry Persistence Detection System

**Domain:** Cybersecurity / Blue Team / Endpoint Security  
**Type:** Practical Detection Engineering Project  
**Author:** Chirayu Paliwal  

---

## üìå Overview

**REGWATCH SENTINEL** is a host-based detection system designed to identify **Windows Registry‚Äìbased persistence mechanisms**, one of the most commonly abused techniques used by attackers to maintain long-term access on compromised systems.

Rather than treating all registry modifications as malicious, REGWATCH SENTINEL applies **context-aware detection logic**, evaluates executable legitimacy, assigns **risk-based severity**, and maps findings to the **MITRE ATT&CK framework**.  
The output is an **analyst-readable detection report**, similar to alerts generated by real-world EDR and SOC platforms.

---

## üéØ Project Objectives

- Monitor critical Windows Registry auto-start locations  
- Detect suspicious registry-based persistence mechanisms  
- Analyze executable context (path, existence, masquerading)  
- Apply rule-based detection logic  
- Assign weighted risk scores instead of binary verdicts  
- Map detections to relevant MITRE ATT&CK techniques  
- Generate structured SOC-style detection reports  

---

## üß† Why This Project Matters

Attackers frequently abuse legitimate registry keys such as **Run** and **RunOnce** to persist silently.  
Traditional antivirus tools often miss these techniques because they rely on static signatures.

REGWATCH SENTINEL focuses on **behavior + context**, mirroring how modern blue teams think:
- *Is the file missing?*
- *Is it executing from a user-writable directory?*
- *Is it masquerading as a system binary?*
- *Is the persistence user-level or system-wide?*

This approach reduces noise while increasing detection confidence.

---

## üèóÔ∏è Architecture Overview

REGWATCH SENTINEL follows a modular pipeline inspired by SOC and EDR tools:

1. **Registry Enumeration Module**  
   - Scans known persistence-related registry keys (Run, RunOnce)

2. **Context Analysis Module**  
   - Checks executable existence  
   - Evaluates file path trust level  
   - Detects masquerading attempts  

3. **Detection Rules Engine**  
   - Applies heuristic-based detection logic  
   - Flags suspicious persistence indicators  

4. **Risk Scoring Module**  
   - Assigns severity levels (LOW / MEDIUM / HIGH)  
   - Calculates weighted risk scores  

5. **MITRE ATT&CK Mapper**  
   - Maps detections to ATT&CK techniques  

6. **Reporting & Telemetry Module**  
   - Generates structured detection reports  

---

## üîç Detection Workflow

1. Enumerate auto-start registry keys  
2. Extract registry values and executable paths  
3. Perform contextual analysis on executables  
4. Apply detection rules  
5. Calculate risk score and severity  
6. Map behavior to MITRE ATT&CK  
7. Generate final detection report  

---

## üß™ Detection Logic Philosophy

REGWATCH SENTINEL does **not** assume registry activity is malicious by default.

Risk increases when multiple signals align:
- Registry-based auto-start persistence  
- Executable located in user-writable directories  
- Masquerading as Windows system binaries  
- Referenced executable missing from disk  

This mirrors **enterprise-grade detection engineering**, where prioritization matters more than volume.

---

## üßÆ Risk Scoring Model

Risk is calculated using a weighted model based on:
- Persistence mechanism presence  
- Executable legitimacy  
- File path trust level  
- Masquerading indicators  
- Combined behavioral context  

This avoids noisy alerts and helps analysts focus on **high-confidence threats**.

---

## üß≠ MITRE ATT&CK Coverage

Detected behaviors are mapped to techniques such as:

- **T1547.001** ‚Äì Boot or Logon Autostart Execution: Registry Run Keys  
- **T1036** ‚Äì Masquerading  
- **T1112** ‚Äì Modify Registry  
- **T1105** ‚Äì Ingress Tool Transfer (contextual correlation)  

---

## üõ†Ô∏è Tools & Technologies

- **Python 3.14** ‚Äì Core detection logic  
- **Windows OS** ‚Äì Target environment  
- **Windows Registry APIs** ‚Äì Registry enumeration  
- **JSON** ‚Äì Rules and telemetry storage  
- **MITRE ATT&CK Framework** ‚Äì Technique mapping  
- **Visual Studio Code & PowerShell** ‚Äì Development & testing  

---

## üìä Results & Observations

During testing, REGWATCH SENTINEL successfully detected:

- Registry entries pointing to non-existent executables  
- Persistence mechanisms using user-writable directories  
- Masquerading binaries named after Windows system processes  
- High-confidence registry-based persistence attempts  

Reports clearly explain *why* an entry is suspicious, not just *that* it is.

---

## ‚ö†Ô∏è False Positives & Analyst Triage

**Expected False Positives**
- Legitimate startup applications  
- Custom user automation scripts  
- Developer or admin auto-run tools  

**How REGWATCH SENTINEL Handles Them**
- Context-aware risk scoring  
- Detailed explanations in reports  
- MITRE mapping to support analyst judgment  

---

## üöÄ How to Run

```bash
python main.py --baseline
python main.py --monitor
